<!DOCTYPE html>
<html xmlns:ng="http://angularjs.org" id='ng-app' ng-app="hcr-map-path">
<head>
    <meta charset="UTF-8">
    <title>Path Creator</title>
    
    <link href="css/pace.css" rel="stylesheet" type="text/css">
    <script src="js/vendor/pace.min.js" type="text/javascript"></script>
    
    <link href="css/bootstrap.css" rel="stylesheet" type="text/css">    
    <link href="js/vendor/leaflet/dist/leaflet.css" rel="stylesheet" type="text/css">
    <link href="js/vendor/leaflet-draw/dist/leaflet.draw.css" rel="stylesheet" type="text/css">
    
    <link href="css/main.css" rel="stylesheet" type="text/css">
</head>

<body ng-controller="MapController">
<!--	You can use either a div having class 'google-map' or the '<google-map>' element; in
	the latter case, uncomment the style above to make sure the custom elements gets block display	-->

    <div class="container">
        <div class="row">
            <h2>Path Creator</h2>
            <button class="btn btn-primary" ng-click="createNewPath()">สร้างเส้นทางใหม่</button>
            <button class="btn btn-default" ng-click="deletePath()">ลบข้อมูลทั้งหมด</button>
        </div>

        <div class="row">
            <leaflet class="map-container"
                     controls="map.controls"  
                     center="map.center"
                     defaults="map.defaults"
                     layers="map.layers"
                     markers="map.markers"
                     geojson="geojson"></leaflet>    
        </div>
        
        <div class="row" ng-cloak class="ng-cloak">
            <div ng-class="pathSelectClass" style="overflow:hidden;">
                <h2>
                    Path <small>{{ path.length}}</span>
                    <button class="btn btn-success" ng-click="doneEditPath()" ng-if="working">Done Edit</button>
                </h2>
                <div ng-repeat="p in path" ng-class="pathListClass" ng-click="editPath($index)">
                    <div class="info-box" style="border-left-color:{{ p.options.color }}">
                        <h4 style="color:{{ p.options.color }};">{{ p.name || p.id }}</h4>
                    </div>
                </div>
            </div>
            
            <div ng-class="pathSelectClass" style="overflow:hidden;">
                <h2>
                    Area <small>{{ area.length}}</span>
                    <button class="btn btn-success" ng-click="doneEditPath()" ng-if="working">Done Edit</button>
                </h2>
                <div ng-repeat="p in area" ng-class="pathListClass" ng-click="editArea($index)">
                    <div class="info-box" style="border-left-color:{{ p.options.color }}">
                        <h4 style="color:{{ p.options.color }};">{{ p.name || p.id }}</h4>
                    </div>
                </div>
            </div>            
            
            
            <div ng-class="pathEditClass" ng-if="working">
                <h3>
                    Edit : 
                    <span style="color:{{ $scope.currentLayer.options.color }};">{{ $storage.mapConfig.polylines[currentPathIndex].name || $storage.mapConfig.polylines[currentPathIndex].id }}</span>
                </h3>
                
                <div class="row form-group">
                    <div class="col-sm-4">
                        <div class="form-group">
                            <label for="input-name">Name</label>
                            <input type="text" class="form-control" id="input-name" placeholder="Name" ng-model="$storage.mapConfig.polylines[currentPathIndex].name">
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-group">
                            <label for="input-color">Color</label>
                            <input type="text" class="form-control" id="input-color" placeholder="Color" ng-model="currentLayerOptions.color">
                        </div>
                    </div>
                    <div class="col-sm-4">
                        <div class="form-group">
                            <label for="input-id">Control</label>
                            <p class="form-control-static">
                                <button class="btn btn-success" ng-click="drawLineToggle()" ng-disabled="editLine">
                                    {{ drawLineToggleButton }}
                                </button>
                                <button class="btn btn-default" ng-click="editLineToggle()" ng-disabled="drawLine">
                                    {{ editLineToggleButton }}
                                </button>
                            </p>
                        </div>
                    </div>
                </div>
                <table class="table table-striped table-hover">
                    <tr>
                        <th>id</th>
                        <th>name</th>
                        <th>station</th>
                        <th>latitude</th>
                        <th>longitude</th>
                        <th>action</th>
                    </tr>
                    <tr ng-repeat="m in $storage.mapConfig.polylines[currentPathIndex].path" ng-if="!$storage.mapConfig.polylines[currentPathIndex].path[0].dummy">
                        <td>
                            {{m.id}}
                        </td>
                        <td>
                            <input type="text" class="form-control" placeholder="Name" ng-model="m.name" ng-blur="redrawMarker()" ng-focus="deleteMarker()">
                        </td>
                        <td>
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox" ng-model="m.station"> Station?
                                </label>
                            </div>
                        </td>
                        <td>
                            <input type="text" class="form-control" placeholder="Latitude" ng-model="m.latitude" ng-blur="redrawMarker($index)" ng-focus="deleteMarker($index)" disabled>
                        </td>
                        <td>
                            <input type="text" class="form-control" placeholder="Longitude" ng-model="m.longitude" ng-blur="redrawMarker($index)" ng-focus="deleteMarker($index)" disabled>
                        </td>
                        <td><a ng-click="deleteInPath($index)">Delete</a>
                        </td>
                    </tr>
                </table>
            </div>
        </div>
    </div>

    <script src="js/vendor/bootstrap-without-jquery/bootstrap3/bootstrap-without-jquery.min.js"></script>
    <script src="http://maps.google.com/maps/api/js?v=3.2&sensor=false"></script>
    <script src="js/vendor/angular/angular.min.js"></script>
    <script src="js/vendor/angular-route/angular-route.min.js"></script>
    <script src="js/vendor/leaflet/dist/leaflet.js"></script>
    <script src="js/vendor/leaflet-draw/dist/leaflet.draw.js"></script>    
    <script src="js/vendor/leaflet-plugins/layer/tile/Google.js"></script>
    <script src='js/vendor/angular-leaflet-directive/dist/angular-leaflet-directive.min.js'></script>
    <script src="js/vendor/angular-local-storage/dist/angular-local-storage.min.js"></script>
    
    <script src="js/path-new.js"></script>
</body>

</html>